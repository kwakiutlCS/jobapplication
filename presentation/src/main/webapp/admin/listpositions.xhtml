<ui:composition template="/resources/layouts/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">


	<ui:define name="title">List Position</ui:define>

	<ui:define name="content">

		<h2>List position page</h2>

		<h:form id="listpositionform">

			<p:dataTable var="position" value="#{listPositionBean.positions}"
				widgetVar="positionsTable"
				emptymessage="No positions found for given criteria"
				filteredValue="#{listPositionBean.filteredPositions}"
				style="text-align: center">

				<f:facet name="header">
					<p:outputPanel>
						<h:outputText value="Search all fields:" />
						<p:inputText id="globalFilter"
							onkeyup="PF('positionsTable').filter()" update="listpositionform"
							placeholder="Enter keyword" />
					</p:outputPanel>
				</f:facet>

				<p:column headerText="Closing date"
					filterBy="#{position.closingDateFormatted}"
					filterMatchMode="contains">
					<h:outputText value="#{position.closingDateFormatted}">
					</h:outputText>
				</p:column>

				<p:column headerText="Code" filterBy="#{position.code}"
					filterMatchMode="contains">
					<h:outputText value="#{position.code}" />
				</p:column>

				<p:column headerText="Title" filterBy="#{position.title}"
					filterMatchMode="contains">
					<h:outputText value="#{position.title}" />
				</p:column>

				<p:column headerText="Situation" filterBy="#{position.state}"
					filterMatchMode="contains">
					<h:outputText value="#{position.state.positionStateLabel}" />
				</p:column>


				<p:column headerText="Location"
					filterBy="#{position.localizationsFormatted}"
					filterMatchMode="contains">
					<ui:repeat value="#{position.localizationsFormatted}" var="l">
  						    #{l}
					</ui:repeat>
				</p:column>

				<p:column headerText="Technical Area" style="width:200px"
					filterBy="#{position.technicalAreasFormatted}"
					filterMatchMode="contains">
					<ui:repeat value="#{position.technicalAreasFormatted}" var="t">
  						    #{t}
					</ui:repeat>
				</p:column>

				<p:column headerText="Company" filterBy="#{position.company}"
					filterMatchMode="contains">
					<h:outputText value="#{position.company}" />
				</p:column>

				<p:column headerText="Detail" style="width:32px;text-align: center">
					<p:commandButton update=":listpositionform :positionDetail"
						oncomplete="PF('Dlg1').show()" icon="ui-icon-search" title="View">
						<f:setPropertyActionListener value="#{position}"
							target="#{listPositionBean.selectedPosition}" />
					</p:commandButton>
				</p:column>

			</p:dataTable>

		</h:form>

		<p:dialog header="Edit Position" widgetVar="Dlg1" modal="true"
			showEffect="fade" hideEffect="fade" resizable="true"
			minimizable="true" maximizable="true">
			<p:outputPanel id="positionDetail" style="text-align:left;">
				<h:form>

					<p:growl id="growl" life="2000" />

					<p:panelGrid columns="2"
						rendered="#{not empty listPositionBean.selectedPosition}"
						columnClasses="label,value">

						
						<h:outputText value="Non editable fields" />
						<h:outputText value="" />
					
						<h:outputText value="Opening date:" />
						<h:outputText
							value="#{listPositionBean.selectedPosition.openingDateFormatted}" />

						<h:outputText value="Code:" />
						<h:outputText value="#{listPositionBean.selectedPosition.code}" />

						<h:outputText value="Closing date:" />
						<h:outputText
							value="#{listPositionBean.selectedPosition.closingDateFormatted}" />

						<h:outputText value="SLA (days):" />
						<h:outputText value="#{listPositionBean.selectedPosition.sla}" />

						<h:outputText value="Company" />
						<h:outputText value="#{listPositionBean.selectedPosition.company}" />

						<h:outputText value="Technical Area" />
						<h:outputText
							value="#{listPositionBean.selectedPosition.technicalAreasFormatted}" />

								<h:outputText value="Editable fields" />
						<h:outputText value="" />

						<h:outputText value="Title:" />
						<p:inplace>
							<p:inputText value="#{listPositionBean.selectedPosition.title}" />
						</p:inplace>

						<h:outputText value="Location:" />
						<p:selectManyCheckbox id="local"
							value="#{listPositionBean.selectedPosition.localizations}"
							converter="localizationConverter">
							<f:selectItems value="#{positionBean.localizations}"
								var="localization" itemValue="#{localization}"
								itemLabel="#{localization.localizationLabel}" />
						</p:selectManyCheckbox>

						<h:outputText value="Situation:" />
						<p:selectOneMenu id="editState"
							value="#{listPositionBean.selectedPosition.state}">
							<f:selectItems value="#{positionBean.positionStates}"
								var="positionState" itemValue="#{positionState}"
								itemLabel="#{positionState.positionStateLabel}" />
						</p:selectOneMenu>

						<h:outputText value="Vacancies:" />
						<p:inplace>
							<p:inputText
								value="#{listPositionBean.selectedPosition.vacancies}" />
						</p:inplace>

						<h:outputText value="Contact person:" />
						<p:inplace>
							<p:inputText
								value="#{listPositionBean.selectedPosition.contactPerson}" />
						</p:inplace>

						<h:outputText value="Description" />
						<p:inputTextarea
							value="#{listPositionBean.selectedPosition.description}" />

						<h:outputText value="Publication channels" />
						<p:selectManyCheckbox id="chan"
							value="#{listPositionBean.selectedPosition.IPublicationChannels}"
							converter="omnifaces.SelectItemsConverter">
							<f:selectItems
								value="#{publicationChannelBean.iPublicationChannels}"
								var="channel" itemValue="#{channel}"
								itemLabel="#{channel.channel}" />
						</p:selectManyCheckbox>

						<p:commandButton value="Save changes" update="growl"
							actionListener="#{listPositionBean.updatePosition(listPositionBean.selectedPosition)}"
							styleClass="ui-priority-primary" />

						<p:commandButton value="Exit" onclick="positionDetail.hide()" />
					</p:panelGrid>
				</h:form>
			</p:outputPanel>
		</p:dialog>


	</ui:define>
</ui:composition>